---
layout: compress
---

{% include base_path %}

<!doctype html>
<html lang="{{ site.locale | slice: 0,2 }}" class="no-js" data-theme="dark">
<head>
  {% include head.html %}
  {% include head/custom.html %}

  <script type="importmap">
  { "imports": {
      "three": "{{ '/assets/vendor/three/three.module.js' | relative_url }}"
  } }
  </script>

  <style>
    html,body{margin:0;height:100%;background:transparent}
    #starfield{position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:-2;pointer-events:none}
    #globe-container{position:fixed;top:0;left:0;z-index:-1;pointer-events:none;overflow:hidden}
    .page,.page__content,.masthead,.initial-content{background:transparent!important}
    /* FIX 1: Keep footer at bottom */
    .page__footer{background:transparent!important;position:relative;z-index:1}
    canvas{display:block}
  </style>
</head>

<body>
  <canvas id="starfield" aria-hidden="true"></canvas>
  <div id="globe-container" aria-hidden="true"></div>
  {% include masthead.html %}
  {{ content }}
  {% include footer/custom.html %}
  {% include footer.html %}
  {% include scripts.html %}

  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from '{{ "/assets/vendor/three/OrbitControls.js" | relative_url }}';

    const IMG = '{{ "/assets/vendor/three/" | relative_url }}';
    const container = document.getElementById('globe-container');

    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(60,1,0.1,1000);
    camera.position.z = 2.5;

    const renderer = new THREE.WebGLRenderer({alpha:true,antialias:true});
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
    container.appendChild(renderer.domElement);

    function resizeGlobe(){
      const s = Math.floor(Math.min(innerWidth,innerHeight)*0.5);
      Object.assign(container.style,{
        width:s+'px',height:s+'px',
        left:(innerWidth-s)/2+'px',
        top :(innerHeight-s)/2+'px'
      });
      renderer.setSize(s,s);
      camera.aspect = 1; camera.updateProjectionMatrix();
    }
    resizeGlobe(); addEventListener('resize',resizeGlobe);

    /* FIX 2: Higher-resolution Earth */
    const loader = new THREE.TextureLoader();
    const earth = new THREE.Mesh(
      new THREE.SphereGeometry(1,256,256), /* â†‘ more segments */
      new THREE.MeshPhongMaterial({
        map      : loader.load(IMG + 'earth-blue-marble.jpg'),
        bumpMap  : loader.load(IMG + 'earth-topology.png'),
        bumpScale: 0.02,
        specular : 0x333333,
        shininess: 5
      })
    );
    scene.add(earth);

    scene.add(new THREE.AmbientLight(0x888888,0.6));
    const sun = new THREE.DirectionalLight(0xffffff,0.8);
    sun.position.set(5,3,5); scene.add(sun);

    const controls = new OrbitControls(camera,renderer.domElement);
    controls.autoRotate = true; 
    /* FIX 3: Faster rotation on mobile */
    controls.autoRotateSpeed = window.innerWidth <= 768 ? 3 : 0.5;
    controls.enableZoom = false; controls.enablePan = false;

    (function animate(){
      requestAnimationFrame(animate);
      if (!document.hidden) {
        controls.update();
        renderer.render(scene,camera);
      }
    })();
  </script>

 <script>
    const c=document.getElementById('starfield'),ctx=c.getContext('2d');
    let w,h; const rs=()=>{w=c.width=innerWidth;h=c.height=innerHeight}; rs(); addEventListener('resize',rs);

    const stars=[...Array(350)].map(()=>({x:Math.random()*w,y:Math.random()*h,r:Math.random()*1.2+0.2,a:Math.random()*0.5+0.5}));
    const mets=[]; 
    setInterval(() => {
      if (document.hidden) return;

      mets.push({
        x: Math.random() * w,
        y: Math.random() * h ,
        vx: 4 + Math.random() * 3,
        vy: 2 + Math.random() * 1.5,
        l: 0
      });
    }, 2000);

    !(function draw(){
      ctx.fillStyle='#121212';ctx.fillRect(0,0,w,h);
      ctx.fillStyle='rgb(80,200,255)';stars.forEach(s=>{ctx.globalAlpha=s.a;ctx.beginPath();ctx.arc(s.x,s.y,s.r,0,6.28);ctx.fill()});
      ctx.globalAlpha=1;
      for(let i=mets.length;i--;){
        const m=mets[i];m.x+=m.vx;m.y+=m.vy;m.l++;
        ctx.strokeStyle=`rgb(80,200,255,${1-m.l/60})`;ctx.lineWidth=2;
        ctx.beginPath();ctx.moveTo(m.x,m.y);ctx.lineTo(m.x-10,m.y-5);ctx.stroke();
        if(m.x>w+50||m.y>h+50||m.l>60) mets.splice(i,1);
      }
      requestAnimationFrame(draw);
    })();
  </script>
</body>
</html>
